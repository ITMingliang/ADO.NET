为什么要使用连接池？

  非常耗时耗力一件事。 经历几个阶段：建立物理通道，与服务器初次的握手，分析连接字符串，身份验证，运行检查。。
  相当的痛苦，重复利用已有的连接？   ---- 连接池
   
连接池是什么？

   优化，   容器：存放了一定数量的与数据库服务器的物理连接。
   
   需要----容器里取出一条空闲的连接，而不是创建一条新的连接。


作用:减少了连接数据库开销，从而提高了应用程序的性能。



分类：类别区分，同一时刻同一应用程序域可以有多个不同类型的连接池。
 
什么来标识区分----进程、应用程序域、连接字符串 windows标识 共同组成的签名来标识区分。
对同一程序域来说，由 连接字符串 来区分。  打开一条连接，如果 这条连接的类型签名与现有的连接不匹配，就会创建一个新
的连接池，反之则不会创建，它们会共用同一个连接池。



如何分配

根据连接请求的类型，找到与它相匹配的连接池，尽力的分配一条空闲的连接。

有空闲的连接，返回这条连接    
已用完，创建一个新连接添加连接池中  
已达到了最大连接数，等待，直到有空闲的连接可用。




移除无效连接

   不能正确的连接到数据库服务器的连接  连接池存储的与数据库服务器的连接数量是有限的。
   
   无效连接，我们应当移除。浪费连接池空间  连接池管理器会处理无效连接的移除问题。



回收连接

   释放使用完的连接？  应当即时关闭或释放，conn对象 的Close  Dispose  连接回到连接池。


Leah QQ 2159674643

下节课：连接池的设置与使用


